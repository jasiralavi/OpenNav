app-id: com.opennav.app
runtime: org.gnome.Platform
runtime-version: '45'
sdk: org.gnome.Sdk
command: opennav
finish-args:
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --device=dri
  # Required to see installed .desktop files on the host
  - --filesystem=/usr/share/applications:ro
  - --filesystem=~/.local/share/applications:ro
  # Required to launch apps on the host
  - --talk-name=org.freedesktop.Flatpak
  
modules:
  - name: opennav
    buildsystem: simple
    build-commands:
      - cargo build --release
      - install -Dm755 target/release/opennav /app/bin/opennav
      - install -Dm644 resources/opennav.png /app/share/icons/hicolor/512x512/apps/com.opennav.app.png
      - install -Dm644 opennav.desktop /app/share/applications/com.opennav.app.desktop
    sources:
      - type: dir
        path: ../
    build-options:
       env:
         # In a real distribution, you generate sources.json for offline build
         # For local testing with network allowed:
         CARGO_HOME: /run/build/opennav/cargo
